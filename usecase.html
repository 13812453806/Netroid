<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang='zh-CN' xml:lang='zh-CN' xmlns='http://www.w3.org/1999/xhtml'>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="robots" content="noindex, nofollow, none, noarchive">
    <link rel="stylesheet" href="/css/site.css" type="text/css" media="screen">
    <title>Netroid Usecase</title>
</head>
<body>
    <div class="container">
        <div class="clearfix">
            <div class="page-title">
    <h1><a href="/">Netroid Usecase</a></h1>
    <h2>last modified : 2014-04-13 15:25</h2>
</div>
<div class="primary">
    <div class="post-thumb">
        <html>
 <head></head>
 <body>
  <h1>使用示例</h1> 
  <p>使用<code>JsonObjectRequest</code>获取一个json对象：</p> 
  <pre><span class="identifier">String</span> <span class="identifier">url</span> <span class="symbol">=</span> <span class="string">&quot;http://server.domain/json_object.do&quot;</span><span class="symbol">;</span>
<span class="identifier">JsonObjectRequest</span> <span class="identifier">request</span> <span class="symbol">=</span> <span class="reserved_word">new</span> <span class="identifier">JsonObjectRequest</span><span class="braces">(</span><span class="identifier">url</span>, <span class="reserved_word">null</span>, <span class="reserved_word">new</span> <span class="identifier">Listener</span><span class="symbol">&lt;</span><span class="identifier">JSONObject</span><span class="symbol">&gt;</span><span class="braces">(</span><span class="braces">)</span> <span class="braces">{</span>
    @<span class="identifier">Override</span>
    <span class="reserved_word">public</span> <span class="reserved_word">void</span> <span class="identifier">onSuccess</span><span class="braces">(</span><span class="identifier">JSONObject</span> <span class="identifier">response</span><span class="braces">)</span> <span class="braces">{</span>
        <span class="identifier">Toast</span>.<span class="identifier">makeText</span><span class="braces">(</span><span class="identifier">Activity</span>.<span class="reserved_word">this</span>, <span class="identifier">response</span>.<span class="identifier">getString</span><span class="braces">(</span><span class="string">&quot;result&quot;</span><span class="braces">)</span>, <span class="numeric">2000</span><span class="braces">)</span>.<span class="identifier">show</span><span class="braces">(</span><span class="braces">)</span><span class="symbol">;</span>
    <span class="braces">}</span>

    @<span class="identifier">Override</span>
    <span class="reserved_word">public</span> <span class="reserved_word">void</span> <span class="identifier">onError</span><span class="braces">(</span><span class="identifier">NetroidError</span> <span class="identifier">error</span><span class="braces">)</span> <span class="braces">{</span>
        <span class="identifier">Toast</span>.<span class="identifier">makeText</span><span class="braces">(</span><span class="identifier">Activity</span>.<span class="reserved_word">this</span>, <span class="string">&quot;error occurred : &quot;</span> <span class="symbol">+</span> <span class="identifier">error</span>.<span class="identifier">getMessage</span><span class="braces">(</span><span class="braces">)</span>, <span class="numeric">2000</span><span class="braces">)</span>.<span class="identifier">show</span><span class="braces">(</span><span class="braces">)</span><span class="symbol">;</span>
    <span class="braces">}</span>
<span class="braces">}</span><span class="braces">)</span><span class="symbol">;</span>

<span class="comment">// 设置请求标识，这个标识可用于终止该请求时传入的Key</span>
<span class="identifier">request</span>.<span class="identifier">setTag</span><span class="braces">(</span><span class="string">&quot;json-request&quot;</span><span class="braces">)</span><span class="symbol">;</span>
<span class="identifier">RequestQueue</span>.<span class="identifier">add</span><span class="braces">(</span><span class="identifier">request</span><span class="braces">)</span><span class="symbol">;</span></pre> 
  <p>使用<code>JsonArrayRequest</code>获取一个json对象列表：</p> 
  <pre><span class="identifier">String</span> <span class="identifier">url</span> <span class="symbol">=</span> <span class="string">&quot;http://server.domain/json_array.do&quot;</span><span class="symbol">;</span>
<span class="identifier">JsonArrayRequest</span> <span class="identifier">request</span> <span class="symbol">=</span> <span class="reserved_word">new</span> <span class="identifier">JsonArrayRequest</span><span class="braces">(</span><span class="identifier">url</span>, <span class="reserved_word">new</span> <span class="identifier">Listener</span><span class="symbol">&lt;</span><span class="identifier">JSONArray</span><span class="symbol">&gt;</span><span class="braces">(</span><span class="braces">)</span> <span class="braces">{</span>
    @<span class="identifier">Override</span>
    <span class="reserved_word">public</span> <span class="reserved_word">void</span> <span class="identifier">onSuccess</span><span class="braces">(</span><span class="identifier">JSONArray</span> <span class="identifier">response</span><span class="braces">)</span> <span class="braces">{</span>
        <span class="identifier">Toast</span>.<span class="identifier">makeText</span><span class="braces">(</span><span class="identifier">Activity</span>.<span class="reserved_word">this</span>, <span class="string">&quot;JSONArray length : &quot;</span> <span class="symbol">+</span> <span class="identifier">response</span>.<span class="identifier">length</span><span class="braces">(</span><span class="braces">)</span>, <span class="numeric">2000</span><span class="braces">)</span>.<span class="identifier">show</span><span class="braces">(</span><span class="braces">)</span><span class="symbol">;</span>
    <span class="braces">}</span>

    @<span class="identifier">Override</span>
    <span class="reserved_word">public</span> <span class="reserved_word">void</span> <span class="identifier">onError</span><span class="braces">(</span><span class="identifier">NetroidError</span> <span class="identifier">error</span><span class="braces">)</span> <span class="braces">{</span>
        <span class="identifier">Toast</span>.<span class="identifier">makeText</span><span class="braces">(</span><span class="identifier">Activity</span>.<span class="reserved_word">this</span>, <span class="string">&quot;error occurred : &quot;</span> <span class="symbol">+</span> <span class="identifier">error</span>.<span class="identifier">getMessage</span><span class="braces">(</span><span class="braces">)</span>, <span class="numeric">2000</span><span class="braces">)</span>.<span class="identifier">show</span><span class="braces">(</span><span class="braces">)</span><span class="symbol">;</span>
    <span class="braces">}</span>
<span class="braces">}</span><span class="braces">)</span><span class="symbol">;</span>

<span class="comment">// 忽略请求的硬盘缓存，直接执行Http操作</span>
<span class="identifier">request</span>.<span class="identifier">setForceUpdate</span><span class="braces">(</span><span class="reserved_word">true</span><span class="braces">)</span><span class="symbol">;</span>
<span class="comment">// Http操作成功后保存进缓存的过期时间</span>
<span class="identifier">request</span>.<span class="identifier">setCacheExpireTime</span><span class="braces">(</span><span class="identifier">TimeUnit</span>.<span class="identifier">MINUTES</span>, <span class="numeric">10</span><span class="braces">)</span><span class="symbol">;</span>
<span class="identifier">RequestQueue</span>.<span class="identifier">add</span><span class="braces">(</span><span class="identifier">request</span><span class="braces">)</span><span class="symbol">;</span></pre> 
  <p>使用<code>StringRequest</code>获取一个字符串结果：</p> 
  <pre><span class="identifier">String</span> <span class="identifier">url</span> <span class="symbol">=</span> <span class="string">&quot;http://server.domain/string.do&quot;</span><span class="symbol">;</span>
<span class="identifier">StringRequest</span> <span class="identifier">request</span> <span class="symbol">=</span> <span class="reserved_word">new</span> <span class="identifier">StringRequest</span><span class="braces">(</span><span class="identifier">Request</span>.<span class="identifier">Method</span>.<span class="identifier">GET</span>, <span class="identifier">url</span>, <span class="reserved_word">new</span> <span class="identifier">Listener</span><span class="symbol">&lt;</span><span class="identifier">String</span><span class="symbol">&gt;</span><span class="braces">(</span><span class="braces">)</span> <span class="braces">{</span>
    @<span class="identifier">Override</span>
    <span class="reserved_word">public</span> <span class="reserved_word">void</span> <span class="identifier">onSuccess</span><span class="braces">(</span><span class="identifier">String</span> <span class="identifier">response</span><span class="braces">)</span> <span class="braces">{</span>
        <span class="identifier">Toast</span>.<span class="identifier">makeText</span><span class="braces">(</span><span class="identifier">Activity</span>.<span class="reserved_word">this</span>, <span class="string">&quot;response : &quot;</span> <span class="symbol">+</span> <span class="identifier">response</span>, <span class="numeric">2000</span><span class="braces">)</span>.<span class="identifier">show</span><span class="braces">(</span><span class="braces">)</span><span class="symbol">;</span>
    <span class="braces">}</span>

    @<span class="identifier">Override</span>
    <span class="reserved_word">public</span> <span class="reserved_word">void</span> <span class="identifier">onError</span><span class="braces">(</span><span class="identifier">NetroidError</span> <span class="identifier">error</span><span class="braces">)</span> <span class="braces">{</span>
        <span class="identifier">Toast</span>.<span class="identifier">makeText</span><span class="braces">(</span><span class="identifier">Activity</span>.<span class="reserved_word">this</span>, <span class="string">&quot;error occurred : &quot;</span> <span class="symbol">+</span> <span class="identifier">error</span>.<span class="identifier">getMessage</span><span class="braces">(</span><span class="braces">)</span>, <span class="numeric">2000</span><span class="braces">)</span>.<span class="identifier">show</span><span class="braces">(</span><span class="braces">)</span><span class="symbol">;</span>
    <span class="braces">}</span>
<span class="braces">}</span><span class="braces">)</span><span class="symbol">;</span>

<span class="comment">// 设置请求Header</span>
<span class="identifier">request</span>.<span class="identifier">addHeader</span><span class="braces">(</span><span class="string">&quot;Accept-Encoding&quot;</span>, <span class="string">&quot;gzip, deflate&quot;</span><span class="braces">)</span><span class="symbol">;</span>
<span class="identifier">RequestQueue</span>.<span class="identifier">add</span><span class="braces">(</span><span class="identifier">request</span><span class="braces">)</span><span class="symbol">;</span></pre> 
  <p>使用<code>ImageRequest</code>获取一张图片：</p> 
  <pre><span class="identifier">String</span> <span class="identifier">url</span> <span class="symbol">=</span> <span class="string">&quot;http://server.domain/sample.jpg&quot;</span><span class="symbol">;</span>
<span class="identifier">ImageRequest</span> <span class="identifier">request</span> <span class="symbol">=</span> <span class="reserved_word">new</span> <span class="identifier">ImageRequest</span><span class="braces">(</span><span class="identifier">url</span>, <span class="reserved_word">new</span> <span class="identifier">Listener</span><span class="symbol">&lt;</span><span class="identifier">Bitmap</span><span class="symbol">&gt;</span><span class="braces">(</span><span class="braces">)</span> <span class="braces">{</span>
    @<span class="identifier">Override</span>
    <span class="reserved_word">public</span> <span class="reserved_word">void</span> <span class="identifier">onSuccess</span><span class="braces">(</span><span class="identifier">Bitmap</span> <span class="identifier">response</span><span class="braces">)</span> <span class="braces">{</span>
        <span class="identifier">ImageView</span>.<span class="identifier">setImageBitmap</span><span class="braces">(</span><span class="identifier">response</span><span class="braces">)</span><span class="symbol">;</span>
    <span class="braces">}</span>

    @<span class="identifier">Override</span>
    <span class="reserved_word">public</span> <span class="reserved_word">void</span> <span class="identifier">onError</span><span class="braces">(</span><span class="identifier">NetroidError</span> <span class="identifier">error</span><span class="braces">)</span> <span class="braces">{</span>
        <span class="identifier">Toast</span>.<span class="identifier">makeText</span><span class="braces">(</span><span class="identifier">Activity</span>.<span class="reserved_word">this</span>, <span class="string">&quot;error occurred : &quot;</span> <span class="symbol">+</span> <span class="identifier">error</span>.<span class="identifier">getMessage</span><span class="braces">(</span><span class="braces">)</span>, <span class="numeric">2000</span><span class="braces">)</span>.<span class="identifier">show</span><span class="braces">(</span><span class="braces">)</span><span class="symbol">;</span>
    <span class="braces">}</span>
<span class="braces">}</span>, <span class="identifier">ImageView</span>.<span class="identifier">getWidth</span><span class="braces">(</span><span class="braces">)</span>, <span class="identifier">ImageView</span>.<span class="identifier">getHeight</span><span class="braces">(</span><span class="braces">)</span>, <span class="identifier">Bitmap</span>.<span class="identifier">Config</span>.<span class="identifier">RGB_565</span><span class="braces">)</span><span class="symbol">;</span>

<span class="comment">// 设置返回结果在硬盘缓存中的过期时间为10天</span>
<span class="identifier">request</span>.<span class="identifier">setCacheExpireTime</span><span class="braces">(</span><span class="identifier">TimeUnit</span>.<span class="identifier">DAYS</span>, <span class="numeric">10</span><span class="braces">)</span><span class="symbol">;</span>
<span class="identifier">RequestQueue</span>.<span class="identifier">add</span><span class="braces">(</span><span class="identifier">request</span><span class="braces">)</span><span class="symbol">;</span></pre> 
  <h4 id="imagerequestimageloader">注：不建议直接使用ImageRequest，推荐使用 <strong>ImageLoader</strong> 来加载图片。</h4> 
  <p>使用Netroid，你的所有Http操作代码都将类似于这样的书写方式。</p> 
 </body>
</html>
    </div>
</div>
        </div>
    </div>
    <div class="footer">
        <div class="aboutus">All pages are generated by <a href="https://github.com/neevek/minerl">Minerl</a></div>
        <div class="findme">Find this project on <a href="https://github.com/vince-styling/netroid.github.com">GitHub</a></div>
    </div>
</body>
</html>